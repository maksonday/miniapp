{"apiVersion":1,"groups":[{"orgId":1,"name":"Alerts","folder":"OnlineShop","interval":"1m","rules":[{"uid":"ef10rhbapdv5sb","title":"Unread Messages By Topic","condition":"C","data":[{"refId":"A","relativeTimeRange":{"from":900,"to":0},"datasourceUid":"prometheus","model":{"adhocFilters":[],"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"max(kafka_client_lag) by (topic,partition)","instant":true,"interval":"","intervalMs":30000,"legendFormat":"__auto","maxDataPoints":43200,"range":false,"refId":"A"}},{"refId":"C","relativeTimeRange":{"from":0,"to":0},"datasourceUid":"__expr__","model":{"conditions":[{"evaluator":{"params":[0],"type":"gt"},"operator":{"type":"and"},"query":{"params":["C"]},"reducer":{"params":[],"type":"last"},"type":"query"}],"datasource":{"type":"__expr__","uid":"__expr__"},"expression":"A","intervalMs":1000,"maxDataPoints":43200,"refId":"C","type":"threshold"}}],"dashboardUid":"4e0ba57a-b15a-46d1-bc89-270798b05d32","panelId":26,"noDataState":"OK","execErrState":"OK","for":"1m","keepFiringFor":"1m","annotations":{"__dashboardUid__":"4e0ba57a-b15a-46d1-bc89-270798b05d32","__panelId__":"26","summary":"Лаг обработки сообщений из Kafka"},"isPaused":false,"notification_settings":{"receiver":"grafana-default-email"}},{"uid":"bf10rv0ws1iiod","title":"Replication Lag","condition":"C","data":[{"refId":"A","relativeTimeRange":{"from":900,"to":0},"datasourceUid":"prometheus","model":{"adhocFilters":[],"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"max(redis_master_last_io_seconds_ago) by (instance)","instant":true,"interval":"","intervalMs":30000,"legendFormat":"__auto","maxDataPoints":43200,"range":false,"refId":"A"}},{"refId":"C","relativeTimeRange":{"from":0,"to":0},"datasourceUid":"__expr__","model":{"conditions":[{"evaluator":{"params":[30],"type":"gt"},"operator":{"type":"and"},"query":{"params":["C"]},"reducer":{"params":[],"type":"last"},"type":"query"}],"datasource":{"type":"__expr__","uid":"__expr__"},"expression":"A","intervalMs":1000,"maxDataPoints":43200,"refId":"C","type":"threshold"}}],"dashboardUid":"4e0ba57a-b15a-46d1-bc89-270798b05d32","panelId":23,"noDataState":"NoData","execErrState":"Error","for":"1m","annotations":{"__dashboardUid__":"4e0ba57a-b15a-46d1-bc89-270798b05d32","__panelId__":"23","summary":"Отстают реплики Redis"},"isPaused":false,"notification_settings":{"receiver":"grafana-default-email"}},{"uid":"df10s1qfw39q8c","title":"Replication Lag","condition":"B","data":[{"refId":"A","relativeTimeRange":{"from":900,"to":0},"datasourceUid":"prometheus","model":{"adhocFilters":[],"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"max(pg_replication_lag_seconds) by (instance)","instant":true,"interval":"","intervalMs":30000,"legendFormat":"__auto","maxDataPoints":43200,"range":false,"refId":"A"}},{"refId":"C","relativeTimeRange":{"from":0,"to":0},"datasourceUid":"__expr__","model":{"conditions":[{"evaluator":{"params":[0],"type":"gt"},"operator":{"type":"and"},"query":{"params":["C"]},"reducer":{"params":[],"type":"last"},"type":"query"}],"datasource":{"type":"__expr__","uid":"__expr__"},"expression":"B","intervalMs":1000,"maxDataPoints":43200,"refId":"C","type":"threshold"}},{"refId":"B","relativeTimeRange":{"from":0,"to":0},"datasourceUid":"__expr__","model":{"conditions":[{"evaluator":{"params":[0,0],"type":"gt"},"operator":{"type":"and"},"query":{"params":[]},"reducer":{"params":[],"type":"avg"},"type":"query"}],"datasource":{"name":"Expression","type":"__expr__","uid":"__expr__"},"expression":"A","hide":false,"intervalMs":1000,"maxDataPoints":43200,"reducer":"max","refId":"B","settings":{"mode":"dropNN"},"type":"reduce"}}],"dashboardUid":"4e0ba57a-b15a-46d1-bc89-270798b05d32","panelId":18,"noDataState":"NoData","execErrState":"Error","for":"1m","annotations":{"__dashboardUid__":"4e0ba57a-b15a-46d1-bc89-270798b05d32","__panelId__":"18","summary":"Отстают реплики PostgreSQL"},"isPaused":false,"notification_settings":{"receiver":"grafana-default-email"}},{"uid":"ef10sb5h2ggzkf","title":"Read DB Errors Rate","condition":"C","data":[{"refId":"A","relativeTimeRange":{"from":900,"to":0},"datasourceUid":"prometheus","model":{"adhocFilters":[],"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum by (service) (rate(db_read_errors_total[1m]))","instant":true,"interval":"","intervalMs":30000,"legendFormat":"__auto","maxDataPoints":43200,"range":false,"refId":"A"}},{"refId":"C","relativeTimeRange":{"from":0,"to":0},"datasourceUid":"__expr__","model":{"conditions":[{"evaluator":{"params":[0],"type":"gt"},"operator":{"type":"and"},"query":{"params":["C"]},"reducer":{"params":[],"type":"last"},"type":"query"}],"datasource":{"type":"__expr__","uid":"__expr__"},"expression":"B","intervalMs":1000,"maxDataPoints":43200,"refId":"C","type":"threshold"}},{"refId":"B","relativeTimeRange":{"from":0,"to":0},"datasourceUid":"__expr__","model":{"conditions":[{"evaluator":{"params":[0,0],"type":"gt"},"operator":{"type":"and"},"query":{"params":[]},"reducer":{"params":[],"type":"avg"},"type":"query"}],"datasource":{"name":"Expression","type":"__expr__","uid":"__expr__"},"expression":"A","hide":false,"intervalMs":1000,"maxDataPoints":43200,"reducer":"max","refId":"B","settings":{"mode":"dropNN"},"type":"reduce"}}],"dashboardUid":"4e0ba57a-b15a-46d1-bc89-270798b05d32","panelId":29,"noDataState":"NoData","execErrState":"Error","for":"1m","annotations":{"__dashboardUid__":"4e0ba57a-b15a-46d1-bc89-270798b05d32","__panelId__":"29","summary":"DB Read Errors"},"isPaused":false,"notification_settings":{"receiver":"grafana-default-email"}},{"uid":"cf10sjoucnrpcc","title":"Write DB Error Rate","condition":"C","data":[{"refId":"A","relativeTimeRange":{"from":900,"to":0},"datasourceUid":"prometheus","model":{"adhocFilters":[],"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum by (service) (rate(db_write_errors_total[1m]))","instant":true,"interval":"","intervalMs":30000,"legendFormat":"__auto","maxDataPoints":43200,"range":false,"refId":"A"}},{"refId":"C","relativeTimeRange":{"from":0,"to":0},"datasourceUid":"__expr__","model":{"conditions":[{"evaluator":{"params":[0],"type":"gt"},"operator":{"type":"and"},"query":{"params":["C"]},"reducer":{"params":[],"type":"last"},"type":"query"}],"datasource":{"type":"__expr__","uid":"__expr__"},"expression":"B","intervalMs":1000,"maxDataPoints":43200,"refId":"C","type":"threshold"}},{"refId":"B","relativeTimeRange":{"from":0,"to":0},"datasourceUid":"__expr__","model":{"conditions":[{"evaluator":{"params":[0,0],"type":"gt"},"operator":{"type":"and"},"query":{"params":[]},"reducer":{"params":[],"type":"avg"},"type":"query"}],"datasource":{"name":"Expression","type":"__expr__","uid":"__expr__"},"expression":"A","hide":false,"intervalMs":1000,"maxDataPoints":43200,"reducer":"max","refId":"B","settings":{"mode":"dropNN"},"type":"reduce"}}],"dashboardUid":"4e0ba57a-b15a-46d1-bc89-270798b05d32","panelId":30,"noDataState":"NoData","execErrState":"Error","for":"1m","keepFiringFor":"1m","annotations":{"__dashboardUid__":"4e0ba57a-b15a-46d1-bc89-270798b05d32","__panelId__":"30","summary":"DB Write Errors"},"isPaused":false,"notification_settings":{"receiver":"grafana-default-email"}},{"uid":"df10smoc7uosga","title":"Process Stock Changes Errors Rate","condition":"C","data":[{"refId":"A","relativeTimeRange":{"from":900,"to":0},"datasourceUid":"prometheus","model":{"adhocFilters":[],"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum by (service) (rate(process_stock_changes_errors_total[1m]))","instant":true,"interval":"","intervalMs":30000,"legendFormat":"__auto","maxDataPoints":43200,"range":false,"refId":"A"}},{"refId":"C","relativeTimeRange":{"from":0,"to":0},"datasourceUid":"__expr__","model":{"conditions":[{"evaluator":{"params":[0],"type":"gt"},"operator":{"type":"and"},"query":{"params":["C"]},"reducer":{"params":[],"type":"last"},"type":"query"}],"datasource":{"type":"__expr__","uid":"__expr__"},"expression":"B","intervalMs":1000,"maxDataPoints":43200,"refId":"C","type":"threshold"}},{"refId":"B","relativeTimeRange":{"from":0,"to":0},"datasourceUid":"__expr__","model":{"conditions":[{"evaluator":{"params":[0,0],"type":"gt"},"operator":{"type":"and"},"query":{"params":[]},"reducer":{"params":[],"type":"avg"},"type":"query"}],"datasource":{"name":"Expression","type":"__expr__","uid":"__expr__"},"expression":"A","hide":false,"intervalMs":1000,"maxDataPoints":43200,"reducer":"last","refId":"B","settings":{"mode":"dropNN"},"type":"reduce"}}],"dashboardUid":"4e0ba57a-b15a-46d1-bc89-270798b05d32","panelId":33,"noDataState":"NoData","execErrState":"Error","for":"1m","keepFiringFor":"1m","annotations":{"__dashboardUid__":"4e0ba57a-b15a-46d1-bc89-270798b05d32","__panelId__":"33","summary":"Ошибки обработки изменений склада"},"isPaused":false,"notification_settings":{"receiver":"grafana-default-email"}},{"uid":"af10sorsgfsw0a","title":"Process Courier Reserve Errors Rate","condition":"C","data":[{"refId":"A","relativeTimeRange":{"from":900,"to":0},"datasourceUid":"prometheus","model":{"adhocFilters":[],"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum by (service) (rate(process_cour_reserve_errors_total[1m]))","instant":true,"interval":"","intervalMs":30000,"legendFormat":"__auto","maxDataPoints":43200,"range":false,"refId":"A"}},{"refId":"C","relativeTimeRange":{"from":0,"to":0},"datasourceUid":"__expr__","model":{"conditions":[{"evaluator":{"params":[0],"type":"gt"},"operator":{"type":"and"},"query":{"params":["C"]},"reducer":{"params":[],"type":"last"},"type":"query"}],"datasource":{"type":"__expr__","uid":"__expr__"},"expression":"B","intervalMs":1000,"maxDataPoints":43200,"refId":"C","type":"threshold"}},{"refId":"B","relativeTimeRange":{"from":0,"to":0},"datasourceUid":"__expr__","model":{"conditions":[{"evaluator":{"params":[0,0],"type":"gt"},"operator":{"type":"and"},"query":{"params":[]},"reducer":{"params":[],"type":"avg"},"type":"query"}],"datasource":{"name":"Expression","type":"__expr__","uid":"__expr__"},"expression":"A","hide":false,"intervalMs":1000,"maxDataPoints":43200,"reducer":"last","refId":"B","settings":{"mode":"dropNN"},"type":"reduce"}}],"dashboardUid":"4e0ba57a-b15a-46d1-bc89-270798b05d32","panelId":35,"noDataState":"NoData","execErrState":"Error","for":"1m","keepFiringFor":"1m","annotations":{"__dashboardUid__":"4e0ba57a-b15a-46d1-bc89-270798b05d32","__panelId__":"35","summary":"Ошибки обработки резерва курьеров"},"isPaused":false,"notification_settings":{"receiver":"grafana-default-email"}},{"uid":"bf10ssmf7kfswc","title":"Process Payments Errors Rate","condition":"C","data":[{"refId":"A","relativeTimeRange":{"from":900,"to":0},"datasourceUid":"prometheus","model":{"adhocFilters":[],"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum by (service) (rate(process_payment_errors_total[1m]))","instant":true,"interval":"","intervalMs":30000,"legendFormat":"__auto","maxDataPoints":43200,"range":false,"refId":"A"}},{"refId":"C","relativeTimeRange":{"from":0,"to":0},"datasourceUid":"__expr__","model":{"conditions":[{"evaluator":{"params":[0],"type":"gt"},"operator":{"type":"and"},"query":{"params":["C"]},"reducer":{"params":[],"type":"last"},"type":"query"}],"datasource":{"type":"__expr__","uid":"__expr__"},"expression":"B","intervalMs":1000,"maxDataPoints":43200,"refId":"C","type":"threshold"}},{"refId":"B","relativeTimeRange":{"from":0,"to":0},"datasourceUid":"__expr__","model":{"conditions":[{"evaluator":{"params":[0,0],"type":"gt"},"operator":{"type":"and"},"query":{"params":[]},"reducer":{"params":[],"type":"avg"},"type":"query"}],"datasource":{"name":"Expression","type":"__expr__","uid":"__expr__"},"expression":"A","hide":false,"intervalMs":1000,"maxDataPoints":43200,"reducer":"last","refId":"B","settings":{"mode":"dropNN"},"type":"reduce"}}],"dashboardUid":"4e0ba57a-b15a-46d1-bc89-270798b05d32","panelId":36,"noDataState":"NoData","execErrState":"Error","for":"1m","keepFiringFor":"1m","annotations":{"__dashboardUid__":"4e0ba57a-b15a-46d1-bc89-270798b05d32","__panelId__":"36","summary":"Ошибки обработки платежей"},"isPaused":false,"notification_settings":{"receiver":"grafana-default-email"}},{"uid":"bf10swrh3g45cb","title":"Latency","condition":"F","data":[{"refId":"A","relativeTimeRange":{"from":900,"to":0},"datasourceUid":"prometheus","model":{"adhocFilters":[],"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"histogram_quantile(0.5, sum by (le)(rate(nginx_ingress_controller_request_duration_seconds_bucket[1m])))","instant":true,"interval":"","intervalMs":30000,"legendFormat":"p50","maxDataPoints":43200,"range":false,"refId":"A"}},{"refId":"B","relativeTimeRange":{"from":900,"to":0},"datasourceUid":"prometheus","model":{"adhocFilters":[],"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"histogram_quantile(0.95, sum by (le)(rate(nginx_ingress_controller_request_duration_seconds_bucket[1m])))","instant":false,"interval":"","intervalMs":30000,"legendFormat":"p95","maxDataPoints":43200,"range":true,"refId":"B"}},{"refId":"C","relativeTimeRange":{"from":900,"to":0},"datasourceUid":"prometheus","model":{"adhocFilters":[],"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"histogram_quantile(0.99, sum by (le)(rate(nginx_ingress_controller_request_duration_seconds_bucket[1m])))","instant":false,"interval":"","intervalMs":30000,"legendFormat":"p99","maxDataPoints":43200,"range":true,"refId":"C"}},{"refId":"D","relativeTimeRange":{"from":900,"to":0},"datasourceUid":"prometheus","model":{"adhocFilters":[],"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"histogram_quantile(1.0, sum by (le)(rate(nginx_ingress_controller_request_duration_seconds_bucket[1m])))","instant":false,"interval":"","intervalMs":30000,"legendFormat":"max","maxDataPoints":43200,"range":true,"refId":"D"}},{"refId":"E","relativeTimeRange":{"from":0,"to":0},"datasourceUid":"__expr__","model":{"conditions":[{"evaluator":{"params":[],"type":"gt"},"operator":{"type":"and"},"query":{"params":["E"]},"reducer":{"params":[],"type":"last"},"type":"query"}],"datasource":{"type":"__expr__","uid":"__expr__"},"expression":"C","intervalMs":1000,"maxDataPoints":43200,"reducer":"last","refId":"E","settings":{"mode":"dropNN"},"type":"reduce"}},{"refId":"F","relativeTimeRange":{"from":0,"to":0},"datasourceUid":"__expr__","model":{"conditions":[{"evaluator":{"params":[1],"type":"gt"},"operator":{"type":"and"},"query":{"params":["F"]},"reducer":{"params":[],"type":"last"},"type":"query"}],"datasource":{"type":"__expr__","uid":"__expr__"},"expression":"E","intervalMs":1000,"maxDataPoints":43200,"refId":"F","type":"threshold"}}],"dashboardUid":"4e0ba57a-b15a-46d1-bc89-270798b05d32","panelId":1,"noDataState":"NoData","execErrState":"Error","for":"1m","keepFiringFor":"1m","annotations":{"__dashboardUid__":"4e0ba57a-b15a-46d1-bc89-270798b05d32","__panelId__":"1","summary":"p99 Response Time \u003e 1 sec"},"isPaused":false,"notification_settings":{"receiver":"grafana-default-email"}},{"uid":"df10t3f5r7474a","title":"Error Rate","condition":"C","data":[{"refId":"A","relativeTimeRange":{"from":900,"to":0},"datasourceUid":"prometheus","model":{"adhocFilters":[],"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum by (namespace) (rate(nginx_ingress_controller_requests{status=~\"4|5..\"}[1m]))","instant":true,"interval":"","intervalMs":30000,"legendFormat":"__auto","maxDataPoints":43200,"range":false,"refId":"A"}},{"refId":"C","relativeTimeRange":{"from":0,"to":0},"datasourceUid":"__expr__","model":{"conditions":[{"evaluator":{"params":[0],"type":"gt"},"operator":{"type":"and"},"query":{"params":["C"]},"reducer":{"params":[],"type":"last"},"type":"query"}],"datasource":{"type":"__expr__","uid":"__expr__"},"expression":"B","intervalMs":1000,"maxDataPoints":43200,"refId":"C","type":"threshold"}},{"refId":"B","relativeTimeRange":{"from":0,"to":0},"datasourceUid":"__expr__","model":{"conditions":[{"evaluator":{"params":[0,0],"type":"gt"},"operator":{"type":"and"},"query":{"params":[]},"reducer":{"params":[],"type":"avg"},"type":"query"}],"datasource":{"name":"Expression","type":"__expr__","uid":"__expr__"},"expression":"A","hide":false,"intervalMs":1000,"maxDataPoints":43200,"reducer":"last","refId":"B","settings":{"mode":"dropNN"},"type":"reduce"}}],"dashboardUid":"4e0ba57a-b15a-46d1-bc89-270798b05d32","panelId":3,"noDataState":"NoData","execErrState":"Error","for":"1m","keepFiringFor":"1m","annotations":{"__dashboardUid__":"4e0ba57a-b15a-46d1-bc89-270798b05d32","__panelId__":"3","summary":"Ошибки HTTP 4xx/5xx"},"isPaused":false,"notification_settings":{"receiver":"grafana-default-email"}}]}]}